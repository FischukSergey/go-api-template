# Woman App Backend - –®–∞–±–ª–æ–Ω Go API —Å Keycloak –∏ PostgreSQL

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –≥–æ—Ç–æ–≤—ã–π —à–∞–±–ª–æ–Ω –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è Go API —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π —á–µ—Ä–µ–∑ Keycloak –∏ –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö PostgreSQL.

## üõ† –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

- **Backend**: Go 1.23+ —Å Chi router
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: PostgreSQL 16
- **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**: Keycloak 24
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: Swagger UI
- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è**: Docker & Docker Compose
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: Go testing + Testify
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: Zap logger

## üìã –ß—Ç–æ –≤—Ö–æ–¥–∏—Ç –≤ —à–∞–±–ª–æ–Ω

- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Keycloak —Å realm –∏ client
- ‚úÖ PostgreSQL —Å –º–∏–≥—Ä–∞—Ü–∏—è–º–∏ –∏ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- ‚úÖ API —Å–µ—Ä–≤–µ—Ä —Å middleware –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- ‚úÖ Debug —Å–µ—Ä–≤–µ—Ä –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- ‚úÖ Swagger UI —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π
- ‚úÖ –¢–µ—Å—Ç–æ–≤–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ì–æ—Ç–æ–≤—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π CI/CD pipeline

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

```bash
# –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone <your-repo-url>
cd woman-app

# –ö–æ–ø–∏—Ä—É–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
cp configs/config.example.yaml configs/config.yaml

# –°–æ–∑–¥–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
cp .env.example .env
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `configs/config.yaml`:

```yaml
# –ò–∑–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
keycloak:
  url: "http://localhost:38081"
  realm: "YourRealm"          # –ò–∑–º–µ–Ω–∏—Ç–µ
  client_id: "your-client"    # –ò–∑–º–µ–Ω–∏—Ç–µ

database:
  host: "localhost"
  port: 37546
  user: "your_user"           # –ò–∑–º–µ–Ω–∏—Ç–µ
  password: "your_password"   # –ò–∑–º–µ–Ω–∏—Ç–µ
  dbname: "your_db"           # –ò–∑–º–µ–Ω–∏—Ç–µ

server:
  port: ":38080"
  debug_port: ":38081"
```

### 3. –ó–∞–ø—É—Å–∫ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

```bash
# –ü–æ–¥–Ω–∏–º–∞–µ–º –≤—Å—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É
docker-compose -f deploy/dev/docker-compose.yml up -d

# –ñ–¥–µ–º –∑–∞–ø—É—Å–∫–∞ —Å–ª—É–∂–± (30-60 —Å–µ–∫—É–Ω–¥)
docker-compose -f deploy/dev/docker-compose.yml logs -f
```

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Keycloak

1. –û—Ç–∫—Ä–æ–π—Ç–µ Keycloak Admin Console: http://localhost:38081
2. –í–æ–π–¥–∏—Ç–µ –∫–∞–∫ admin (–ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å –≤ docker-compose.yml)
3. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π realm –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ client –¥–ª—è –≤–∞—à–µ–≥–æ API
5. –û–±–Ω–æ–≤–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤ `configs/config.yaml`

### 5. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
# –ü—Ä–∏–º–µ–Ω—è–µ–º –º–∏–≥—Ä–∞—Ü–∏–∏
task db:migrate:up

# –ò–ª–∏ —á–µ—Ä–µ–∑ Docker
docker exec -it woman-app-db psql -U youruser -d yourdb -f /migrations/001_initial_schema.sql
```

### 6. –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫ API

```bash
# –°–±–æ—Ä–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
go build -o main-service ./cmd/main-service

# –ó–∞–ø—É—Å–∫ API —Å–µ—Ä–≤–µ—Ä–∞
./main-service

# –ò–ª–∏ —á–µ—Ä–µ–∑ Docker
docker-compose -f deploy/dev/docker-compose.yml up api-server
```

### 7. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ health endpoint
curl http://localhost:38080/health

# –ü—Ä–æ–≤–µ—Ä–∫–∞ Swagger UI
open http://localhost:38080/docs/

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
curl -X POST http://localhost:38080/api/v1/auth/register \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","password":"password123"}'
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
woman-app/
‚îú‚îÄ‚îÄ api/                    # HTTP handlers
‚îÇ   ‚îú‚îÄ‚îÄ auth/              # –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ user/              # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
‚îú‚îÄ‚îÄ cmd/                   # –¢–æ—á–∫–∏ –≤—Ö–æ–¥–∞
‚îÇ   ‚îî‚îÄ‚îÄ main-service/      # –û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å
‚îú‚îÄ‚îÄ configs/               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ deploy/                # Docker –∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ dev/              # Development –æ–∫—Ä—É–∂–µ–Ω–∏–µ
‚îÇ   ‚îî‚îÄ‚îÄ local/            # –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
‚îú‚îÄ‚îÄ internal/              # –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ clients/          # –í–Ω–µ—à–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—ã (Keycloak)
‚îÇ   ‚îú‚îÄ‚îÄ config/           # –ü–∞—Ä—Å–∏–Ω–≥ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ middlewares/      # HTTP middleware
‚îÇ   ‚îú‚îÄ‚îÄ models/           # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ service/          # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ store/            # –°–ª–æ–π –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ docs/                  # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îî‚îÄ‚îÄ tests/                 # –¢–µ—Å—Ç—ã
```

## üõ† –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤

1. –°–æ–∑–¥–∞–π—Ç–µ handler –≤ `api/`
2. –î–æ–±–∞–≤—å—Ç–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –≤ `internal/service/`
3. –î–æ–±–∞–≤—å—Ç–µ —Ä–∞–±–æ—Ç—É —Å –ë–î –≤ `internal/store/`
4. –û–±–Ω–æ–≤–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –≤ `deploy/dev/docs/api.yaml`
5. –î–æ–±–∞–≤—å—Ç–µ —Ç–µ—Å—Ç—ã

### –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏
task db:migration:create NAME=add_new_table

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
task db:migrate:up

# –û—Ç–∫–∞—Ç –º–∏–≥—Ä–∞—Ü–∏–π
task db:migrate:down

# –ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
task db:backup
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
go test ./...

# –¢–µ—Å—Ç—ã —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º
go test -cover ./...

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤–æ–π –ë–î
task db:test:up
```

## üê≥ Docker –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞
docker-compose -f deploy/dev/docker-compose.yml build --no-cache

# –õ–æ–≥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker-compose -f deploy/dev/docker-compose.yml logs -f api-server

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose -f deploy/dev/docker-compose.yml down

# –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
docker-compose -f deploy/dev/docker-compose.yml down -v
```

## üîß –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç

### 1. –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –º–æ–¥—É–ª—è

```bash
# –ó–∞–º–µ–Ω–∏—Ç–µ –≤—Å–µ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –º–æ–¥—É–ª—è
find . -name "*.go" -exec sed -i 's/github.com\/Fisher-Development\/woman-app-backend/your-new-module/g' {} \;

# –û–±–Ω–æ–≤–∏—Ç–µ go.mod
go mod edit -module your-new-module
go mod tidy
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ—Ä—Ç–æ–≤

–ò–∑–º–µ–Ω–∏—Ç–µ –ø–æ—Ä—Ç—ã –≤:
- `deploy/dev/docker-compose.yml`
- `configs/config.yaml`
- `deploy/dev/docs/api.yaml`

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Keycloak

- –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π realm
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ client_id –∏ —Å–µ–∫—Ä–µ—Ç—ã
- –û–±–Ω–æ–≤–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

### 4. –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è API

- –ó–∞–º–µ–Ω–∏—Ç–µ –º–æ–¥–µ–ª–∏ –≤ `internal/models/`
- –û–±–Ω–æ–≤–∏—Ç–µ –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤ `internal/service/validation.go`
- –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–î–æ—Å—Ç—É–ø–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:

- `GET /health` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–∏—Å–∞
- `GET /info` - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Ä–≤–∏—Å–µ
- `GET /api/v1/version` - –í–µ—Ä—Å–∏—è API

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –í—Å–µ –∑–∞—â–∏—â–µ–Ω–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ç—Ä–µ–±—É—é—Ç JWT —Ç–æ–∫–µ–Ω
- –í–∞–ª–∏–¥–∞—Ü–∏—è —á–µ—Ä–µ–∑ Keycloak
- CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è development
- –ì–æ—Ç–æ–≤—ã–µ middleware –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

## üìù –ü—Ä–∏–º–µ—Ä—ã API

### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```bash
curl -X POST http://localhost:38080/api/v1/auth/register \
  -H "Content-Type: application/json" \
  -d '{"email":"user@example.com","password":"password123"}'
```

### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
```bash
curl -X POST http://localhost:38080/api/v1/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"user@example.com","password":"password123"}'
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
```bash
curl -X PUT http://localhost:38080/api/v1/user/update \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -d '{"firstName":"John","lastName":"Doe"}'
```

## ü§ù –£—á–∞—Å—Ç–∏–µ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

1. Fork –ø—Ä–æ–µ–∫—Ç–∞
2. –°–æ–∑–¥–∞–π—Ç–µ feature branch
3. –í–Ω–µ—Å–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ –¥–æ–±–∞–≤—å—Ç–µ —Ç–µ—Å—Ç—ã
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã –∏ –ª–∏–Ω—Ç–µ—Ä—ã
5. –°–æ–∑–¥–∞–π—Ç–µ Pull Request

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ —Ñ–∞–π–ª–µ LICENSE

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- Issues: —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ issue –≤ GitHub
- Email: support@your-domain.com
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ Swagger UI

---

**üéØ –ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É:** –≠—Ç–æ—Ç —à–∞–±–ª–æ–Ω –≤–∫–ª—é—á–∞–µ—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è production-ready API —Å–µ—Ä–≤–∏—Å–∞.
